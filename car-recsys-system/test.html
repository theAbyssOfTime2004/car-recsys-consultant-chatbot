<!DOCTYPE html>
<html>
<head>
    <title>Test Car API</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .vehicle { border: 1px solid #ddd; padding: 15px; margin: 10px 0; }
        .vehicle img { max-width: 300px; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Car API Test</h1>
    <div id="status">Loading...</div>
    <div id="vehicles"></div>

    <script>
        const API_URL = 'http://localhost:8000/api/v1';
        
        async function testAPI() {
            const status = document.getElementById('status');
            const vehiclesDiv = document.getElementById('vehicles');
            
            try {
                // Test search
                console.log('Fetching vehicles...');
                const response = await fetch(`${API_URL}/search?page_size=5`);
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Data:', data);
                
                status.innerHTML = `<div style="color: green;">✓ Found ${data.total} vehicles, showing ${data.results.length}</div>`;
                
                data.results.forEach(vehicle => {
                    const div = document.createElement('div');
                    div.className = 'vehicle';
                    div.innerHTML = `
                        <h3>${vehicle.title || 'Untitled'}</h3>
                        <p><strong>Brand:</strong> ${vehicle.brand || 'N/A'} | <strong>Model:</strong> ${vehicle.model || 'N/A'}</p>
                        <p><strong>Price:</strong> ${vehicle.price ? vehicle.price.toLocaleString() + ' VND' : 'N/A'}</p>
                        <p><strong>Year:</strong> ${vehicle.year || 'N/A'} | <strong>Mileage:</strong> ${vehicle.mileage ? vehicle.mileage.toLocaleString() + ' km' : 'N/A'}</p>
                        ${vehicle.image_url ? `<img src="${vehicle.image_url}" alt="${vehicle.title}">` : '<p>No image</p>'}
                    `;
                    vehiclesDiv.appendChild(div);
                });
                
            } catch (error) {
                console.error('Error:', error);
                status.innerHTML = `<div class="error">✗ Error: ${error.message}</div>`;
            }
        }
        
        testAPI();
    </script>
</body>
</html>
